(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-310c323e"],{"386d":function(t,a,e){"use strict";var o=e("cb7c"),n=e("83a1"),s=e("5f1b");e("214f")("search",1,(function(t,a,e,r){return[function(e){var o=t(this),n=void 0==e?void 0:e[a];return void 0!==n?n.call(e,o):new RegExp(e)[a](String(o))},function(t){var a=r(e,t,this);if(a.done)return a.value;var i=o(t),c=String(this),u=i.lastIndex;n(u,0)||(i.lastIndex=0);var l=s(i,c);return n(i.lastIndex,u)||(i.lastIndex=u),null===l?-1:l.index}]}))},"3b2b":function(t,a,e){var o=e("7726"),n=e("5dbc"),s=e("86cc").f,r=e("9093").f,i=e("aae3"),c=e("0bfb"),u=o.RegExp,l=u,d=u.prototype,m=/a/g,p=/a/g,f=new u(m)!==m;if(e("9e1e")&&(!f||e("79e5")((function(){return p[e("2b4c")("match")]=!1,u(m)!=m||u(p)==p||"/a/i"!=u(m,"i")})))){u=function(t,a){var e=this instanceof u,o=i(t),s=void 0===a;return!e&&o&&t.constructor===u&&s?t:n(f?new l(o&&!s?t.source:t,a):l((o=t instanceof u)?t.source:t,o&&s?c.call(t):a),e?this:d,u)};for(var h=function(t){t in u||s(u,t,{configurable:!0,get:function(){return l[t]},set:function(a){l[t]=a}})},v=r(l),g=0;v.length>g;)h(v[g++]);d.constructor=u,u.prototype=d,e("2aba")(o,"RegExp",u)}e("7a56")("RegExp")},"49ee":function(t,a,e){},"654a":function(t,a,e){},"77c9":function(t,a,e){"use strict";e("49ee")},"7d3e":function(t,a,e){},"83a1":function(t,a){t.exports=Object.is||function(t,a){return t===a?0!==t||1/t===1/a:t!=t&&a!=a}},b3ca:function(t,a,e){"use strict";e("7d3e")},e49c:function(t,a,e){"use strict";e.r(a);var o=function(){var t=this,a=t._self._c;return a("div",{staticClass:"login"},[a("div",{staticClass:"login-con"},[a("Card",{attrs:{icon:"log-in",title:"欢迎登录",bordered:!1}},[a("div",{staticClass:"form-con"},[a("login-form",{on:{"on-success-valid":t.handleSubmit,"on-activate-again":t.activateAgain}})],1)])],1),a("ActivateDlg",{attrs:{modalId:t.authModalId},on:{"auth-success":t.authSuccess,"auth-failed":t.authFailed}}),a("Toast",{attrs:{toastId:t.toastId,text:t.toastText,iconDacha:t.iconDacha}}),a("SimpleModalDlg",{attrs:{modalId:t.alertModalId,content:t.alertConent,defaultButtonText:"确认",defaultButtonAction:t.showAuthModal}})],1)},n=[],s=function(){var t=this,a=t._self._c;return a("Form",{ref:"loginForm",attrs:{model:t.form,rules:t.rules}},[a("FormItem",{attrs:{prop:"userName"}},[a("Input",{attrs:{placeholder:"请输入用户名"},model:{value:t.form.userName,callback:function(a){t.$set(t.form,"userName",a)},expression:"form.userName"}},[a("span",{attrs:{slot:"prepend"},slot:"prepend"},[a("Icon",{attrs:{size:16,type:"ios-person"}})],1)])],1),a("div",{staticClass:"row"},[a("div",{staticClass:"login-blank-row"})]),a("FormItem",{attrs:{prop:"password"}},[a("Input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:t.form.password,callback:function(a){t.$set(t.form,"password",a)},expression:"form.password"}},[a("span",{attrs:{slot:"prepend"},slot:"prepend"},[a("Icon",{attrs:{size:14,type:"md-lock"}})],1)])],1),a("div",{staticClass:"row"},[a("div",{staticClass:"login-blank-row"})]),a("FormItem",[a("Button",{attrs:{type:"primary",long:""},on:{click:t.handleSubmit}},[t._v("登录")])],1),a("div",{staticClass:"row"},[a("div",{staticClass:"login-blank-row"})]),a("FormItem",[a("Button",{attrs:{type:"primary",long:""},on:{click:t.activateAgain}},[t._v("激活 / 重新激活")])],1)],1)},r=[],i={name:"LoginForm",props:{userNameRules:{type:Array,default:function(){return[{required:!0,message:"账号不能为空",trigger:"blur"}]}},passwordRules:{type:Array,default:function(){return[{required:!0,message:"密码不能为空",trigger:"blur"}]}}},data:function(){return{form:{userName:"",password:""}}},computed:{rules:function(){return{userName:this.userNameRules,password:this.passwordRules}}},methods:{handleSubmit:function(){var t=this;this.$refs.loginForm.validate((function(a){a&&t.$emit("on-success-valid",{userName:t.form.userName,password:t.form.password})}))},activateAgain:function(){this.$emit("on-activate-again")}}},c=i,u=(e("e691"),e("2877")),l=Object(u["a"])(c,s,r,!1,null,null,null),d=l.exports,m=d,p=function(){var t=this,a=t._self._c;return a("SimpleModalDlg",{attrs:{modalId:t.modalId,title:"系统激活",content:"",defaultButtonText:"激活",defaultButtonAction:t.defaultButtonAction,dialogWidth:600,showClose:!1},scopedSlots:t._u([{key:"bodyPost",fn:function(){return[a("div",{staticClass:"container-fluid"},[a("div",{staticClass:"row"},[a("div",{staticClass:"activate-top-blank"})]),a("div",{staticClass:"row text-right"},[a("div",{staticClass:"col-3"},[a("span",{staticClass:"field-label-non-bold"},[t._v("项目名称：")])]),a("div",{staticClass:"col mb-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.projectName,expression:"projectName"}],staticClass:"form-control atviation-form-input mr-1",domProps:{value:t.projectName},on:{input:function(a){a.target.composing||(t.projectName=a.target.value)}}})])]),a("div",{staticClass:"row text-right"},[a("div",{staticClass:"col-3"},[a("span",{staticClass:"field-label-non-bold"},[t._v("授权码：")])]),a("div",{staticClass:"col mb-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.authCode,expression:"authCode"}],staticClass:"form-control atviation-form-input mr-1",domProps:{value:t.authCode},on:{input:function(a){a.target.composing||(t.authCode=a.target.value)}}})])]),a("div",{staticClass:"row text-right"},[a("div",{staticClass:"col-3"},[a("span",{staticClass:"field-label-non-bold"},[t._v("用户名：")])]),a("div",{staticClass:"col mb-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],staticClass:"form-control atviation-form-input mr-1",domProps:{value:t.username},on:{input:function(a){a.target.composing||(t.username=a.target.value)}}})])]),a("div",{staticClass:"row text-right"},[a("div",{staticClass:"col-3"},[a("span",{staticClass:"field-label-non-bold"},[t._v("密码：")])]),a("div",{staticClass:"col mb-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.password1,expression:"password1"}],staticClass:"form-control atviation-form-input mr-1",attrs:{type:"password"},domProps:{value:t.password1},on:{input:function(a){a.target.composing||(t.password1=a.target.value)}}})])]),a("div",{staticClass:"row text-right"},[a("div",{staticClass:"col-3"},[a("span",{staticClass:"field-label-non-bold"},[t._v("密码(再次输入)：")])]),a("div",{staticClass:"col mb-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.password2,expression:"password2"}],staticClass:"form-control atviation-form-input mr-1",attrs:{type:"password"},domProps:{value:t.password2},on:{input:function(a){a.target.composing||(t.password2=a.target.value)}}})])]),a("div",{staticClass:"row"},[a("div",{staticClass:"activate-bottom-blank"})])])]},proxy:!0}])})},f=[],h=e("fa7d"),v=e("0be2"),g={name:"ActivateDlg",components:{},data:function(){return{username:"",password1:"",password2:"",projectName:"",authCode:""}},props:{modalId:{type:String,required:!0}},computed:{projectNameValid:function(){return this.projectName.trim().length>0},authCodeValid:function(){return 32===this.authCode.trim().length},usernameValid:function(){return this.username.trim().length>0},password1Valid:function(){return this.password1.length>=6},password2Valid:function(){return this.password2.length>=6&&this.password1===this.password2}},methods:{authFailed:function(t){return this.$emit("auth-failed",t),0},defaultButtonAction:function(){var t=this,a="system/projectinfos/activate/",e={};return this.projectNameValid?(e["project_name"]=this.projectName.trim(),this.authCodeValid?(e["auth_code"]=this.authCode.trim(),this.usernameValid?(e["username"]=this.username.trim(),this.password1!==this.password2?this.authFailed("两次密码输入必须一致！"):this.password1Valid?(e["password"]=this.password1,void v["a"].apiAjaxPost(a,e,(function(a){if(console.log("Activate return",a),0!==a.code)return t.authFailed("激活失败(".concat(a.code,"): ").concat(a.message));t.$emit("auth-success")}),(function(a){return t.authFailed(JSON.stringify(a))}))):this.authFailed("密码太短！")):this.authFailed("用户名不能为空！")):this.authFailed("授权码不能为空！")):this.authFailed("项目名称不能为空！")}},watch:{},mounted:function(){}},w=g,b=(e("77c9"),Object(u["a"])(w,p,f,!1,null,null,null)),C=b.exports,x=e("5f87"),y=e("f953"),I=e("8cbb"),j={components:{LoginForm:m,ActivateDlg:C},data:function(){return{toastId:h["a"].randomId("toast"),authModalId:h["a"].randomId("modal"),alertModalId:h["a"].randomId("modal"),alertConent:"",toastText:"",iconDacha:!0}},methods:{showToast:function(t,a){this.toastText=a,this.iconDacha=t,I["a"].showToast(this.toastId)},authFailed:function(t){var a=this;this.showToast(!0,t),setTimeout((function(){$("#".concat(a.authModalId)).modal("show")}),2500)},showAuthModal:function(){y["a"].show(this.authModalId)},authSuccess:function(){var t=this;this.showToast(!1,"激活成功！"),setTimeout((function(){var a="system/projectinfos/auth_info/";v["a"].apiAjaxGet(a,{},(function(a){0===a.code&&a.data?Object(x["h"])(a.data):t.showToast(!0,"激活失败，请确认授权码有效！")}),h["a"].defaultApiErrorHandler(a,""))}),2500)},handleSubmit:function(t){var a=this,e=t.userName,o=t.password,n="api-token-auth/";v["a"].apiAjaxPost(n,{username:e,password:o},(function(t){"token"in t?(Object(x["k"])(e),Object(x["i"])(t["token"]),Object(x["j"])(t["token"],{access:["super_admin","admin"]}),a.$emit("login-success"),a.$router.push({name:a.$config.homeName})):a.showToast(!0,"用户名或密码错误！")}),h["a"].defaultApiErrorHandler(n,""))},activateAgain:function(){$("#".concat(this.authModalId)).modal("show")}},mounted:function(){var t=this;Object(x["d"])()||setTimeout((function(){$("#".concat(t.authModalId)).modal("show")}),1e3)}},N=j,_=(e("b3ca"),Object(u["a"])(N,o,n,!1,null,null,null));a["default"]=_.exports},e691:function(t,a,e){"use strict";e("654a")},fa7d:function(t,a,e){"use strict";e("456d"),e("ac6a");var o=e("53ca");e("7514"),e("28a5"),e("a481"),e("3b2b"),e("386d");a["a"]={nextTableSelectedIndex:function(t,a){var e=a+1;while(e<t.length){if(t[e].selected)break;e++}return e},downloadFile:function(t){var a=document.createElement("iframe");a.style.display="none",a.style.height=0,a.src=t,document.body.appendChild(a),setTimeout((function(){a.remove()}),3e5)},randomString:function(t){for(var a=t||8,e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",o=e.length,n="",s=0;s<a;s++)n+=e.charAt(Math.floor(Math.random()*o));return n},randomId:function(t){return"".concat(t,"-").concat(this.randomString())},getProtocolHostPort:function(){var t=document.location.protocol;":"===!t.substr(t.length-1,1)&&(t+=":");var a=document.location.host;return a.search(":"+document.location.port)<0&&(a+=":"+document.location.port),"".concat(t,"//").concat(a)},getThumbPathPrefix:function(){return"".concat(this.getProtocolHostPort(),"/nc19api/v1/fileservice/images/")},getThumbPathPostfix:function(t){return"thumb/?thumb_size=".concat(t,"&id=")},replaceChinese:function(t){var a={"：":":","，":",","；":";","？":"?","‘":"'","’":"'","“":'"',"”":'"',"！":"!","＃":"#","＆":"&","×":"*","（":"(","）":")","－":"-","—":"_","＋":"+","＝":"=","｛":"{","｝":"}","【":"[","】":"]","｜":"|","～":"~","《":"<","》":">","​":"","＞":">","＜":"<","★":"*","。":". ","、":"\\","∽":"~","￠":"","":"","氧传感":"Oxygen Sensor","(盎司)":"(ounces)","．":". "};for(var e in a){var o=new RegExp(e,"g");t=t.replace(o,a[e])}return t},filterEnglishOrSymbol:function(t){return t&&t.search(/[\u4e00-\u9fa5]/)>=0?"Chinese Characters":""},getProductEditUrl:function(t,a,e,o,n){var s=t.$router.resolve({path:"/products/products/productedit",query:{product_id:a,source:e,auto_save:o?1:0,view_only:n?1:0}});return s},openProductEditPageEx:function(t,a,e,o){var n=this.getProductEditUrl(t,a,e,o);window.open(n.href,"_blank")},openProductEditPage:function(t,a,e){this.openProductEditPageEx(t,a,e,0)},getDateFromDateTimeString:function(t){return t.split("T")[0]},getImageThumbById:function(t,a,e){var o="".concat(t.img_root,"thumb/?id=").concat(a);return e&&(o="".concat(o,"&thumb_size=").concat(e)),o},getImageThumbByName:function(t,a,e){var o="".concat(t.img_root,"thumb/").concat(a);return e&&(o="".concat(o,"?thumb_size=").concat(e)),o},getImageLinkByName:function(t,a){return"".concat(t.img_root).concat(a)},getLabelFromOptionMap:function(t,a,e,o){var n=t.find((function(t){return t[a]===o}));return n[e]},getDayDiff:function(t,a){return(new Date(t).getTime()-new Date(a))/864e5},defaultApiErrorHandler:function(t,a){return function(e){console.log("".concat(t," failed(").concat(a,"): "),e),"response"in e&&"data"in e.response&&e.response.data instanceof Object&&"data"in e.response.data&&e.response.data.data}},arrayEqual:function(t,a){if(!t||!a)return!t&&!a;if(t.length!==a.length)return!1;for(var e=0;e<t.length;e++)if(t[e]instanceof Array&&a[e]instanceof Array){if(!this.arrayEqual(t[e],a[e]))return!1}else if(t[e]!==a[e])return!1;return!0},deepCopy:function(t){var a=this;if(null===t||"object"!==Object(o["a"])(t))return t;var e=Array.isArray(t)?[]:{};return Object.keys(t).forEach((function(o){e[o]=a.deepCopy(t[o])})),e},eval:function(t){var a=Function;return new a("return "+t)()},getImageUrl:function(t){return"".concat("/static/images","/").concat(t)}}}}]);