(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2ef7e2ee"],{"2e2d":function(t,e,n){"use strict";n("b1e1")},3846:function(t,e,n){n("9e1e")&&"g"!=/./g.flags&&n("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:n("0bfb")})},4447:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container-fluid"},[e("div",{staticClass:"row w-100 ml-1 my-2"},[e("div",{staticClass:"row ml-1 my-2"},[e("button",{staticClass:"btn btn-primary btn-sm btn-iview-size",attrs:{disabled:t.usedNos.length===t.availNos.length,"data-toggle":"modal","data-target":"#"+t.channelEditDlgId}},[t._v("添加通道")]),e("button",{staticClass:"btn btn-light ml-4 btn-sm btn-iview-size",attrs:{disabled:!0}},[t._v("已用通道 "+t._s(t.usedNos.length)+"/"+t._s(t.availNos.length))])]),e("div",{staticClass:"row w-100 mt-4"},[e("ApiDataTable",{attrs:{handlers:t.tableHandlers,tableId:"channelListTableId",dataHeight:400,showWaitingDlg:!1,showSearch:!1,detailView:!1}})],1),e("ChannelEditDlg",{attrs:{modalId:t.channelEditDlgId,channelId:t.currRowChannelId,availNos:t.availNos,freeNos:t.freeNos},on:{"channel-saved":t.onChannelSaved,"channel-save-failed":t.onChannelSaveFailed}}),e("ChannelDeleteDlg",{attrs:{modalId:t.channelDeleteDlgId,channelId:t.currRowChannelId,cno:t.currRowChannelNo},on:{"channel-deleted":t.onChannelDeleted}})],1),e("Toast",{attrs:{toastId:t.toastId,text:t.toastText,iconDacha:t.iconDacha}})],1)},o=[],i=(n("ac6a"),n("7f7f"),n("55dd"),n("2909")),r=n("f217"),s=n("fa7d"),l=n("1157"),c=n.n(l),d=function(){var t=this,e=t._self._c;return e("div",[e("SimpleModalDlg",{attrs:{modalId:t.modalId,title:t.channelId?"编辑通道":"添加通道",content:"",defaultButtonText:"取消",button2Text:"保存",button2Action:t.button2Action,dialogWidth:600},scopedSlots:t._u([{key:"bodyPost",fn:function(){return[e("div",{staticClass:"container-fluid"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-3"},[e("span",{staticClass:"field-label"},[t._v("通道ID：")])]),e("div",{staticClass:"col mb-1"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.cid,expression:"cid"}],staticClass:"mr-1 channel-edit-input",attrs:{disabled:!0},domProps:{value:t.cid},on:{input:function(e){e.target.composing||(t.cid=e.target.value)}}})])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-3"},[e("span",{staticClass:"field-label"},[t._v("通道号：")])]),e("div",{staticClass:"col mb-1"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.cno,expression:"cno"}],attrs:{disabled:t.channelId>0,name:"selectList"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.cno=e.target.multiple?n:n[0]}}},t._l(t._freeNos,(function(n,a){return e("option",{key:t.modalId+t.uniqueId+a},[t._v(t._s(n))])})),0)])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-3"},[e("span",{staticClass:"field-label field-required"},[t._v("通道名称：")])]),e("div",{staticClass:"col mb-1"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"mr-1 channel-edit-input",domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}}),e("IconFont",{class:t.nameValid?"dagou-icon":"dacha-icon",attrs:{iconName:t.nameValid?"icon-dagouyouquan":"icon-cuowuguanbiquxiao-yuankuang"}})],1)]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-3"},[e("span",{staticClass:"field-label field-required"},[t._v("通道位置：")])]),e("div",{staticClass:"col mb-1"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.site,expression:"site"}],staticClass:"mr-1 channel-edit-input",domProps:{value:t.site},on:{input:function(e){e.target.composing||(t.site=e.target.value)}}}),e("IconFont",{class:t.siteValid?"dagou-icon":"dacha-icon",attrs:{iconName:t.siteValid?"icon-dagouyouquan":"icon-cuowuguanbiquxiao-yuankuang"}})],1)]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-3"},[e("span",{staticClass:"field-label field-required"},[t._v("URL：")])]),e("div",{staticClass:"col mb-1"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.url,expression:"url"}],staticClass:"mr-1 channel-edit-input",domProps:{value:t.url},on:{input:function(e){e.target.composing||(t.url=e.target.value)}}}),e("IconFont",{class:t.urlValid?"dagou-icon":"dacha-icon",attrs:{iconName:t.urlValid?"icon-dagouyouquan":"icon-cuowuguanbiquxiao-yuankuang"}})],1)])])]},proxy:!0}])})],1)},u=[],h=(n("6b54"),n("c5f6"),n("f953")),f=n("0be2"),b=n("69a0"),p=n.n(b),g={name:"ChannelEditDlg",components:{SimpleModalDlg:h["a"]},data:function(){return{uniqueId:s["a"].randomString(),cno:"",cid:"",name:"",site:"",url:""}},props:{modalId:{type:String,required:!0},channelId:{type:Number,required:!0},availNos:{type:Array,required:!0},freeNos:{type:Array,required:!0}},computed:{cnoValid:function(){return!!this.cno},cidValid:function(){return 32===this.cid.trim().length},nameValid:function(){return this.name.trim().length>0},siteValid:function(){return this.site.length>0},urlValid:function(){return this.url.length>=10},_freeNos:function(){return this.channelId>0?[].concat(Object(i["a"])(this.freeNos),[this.cno]):this.freeNos}},methods:{channelSaveFailed:function(t){this.$emit("channel-save-failed",t)},button2Action:function(){var t=this,e="channel/channels/",n={};if(this.cnoValid)if(n["cno"]=this.cno,this.cidValid)if(n["cid"]=this.cid.trim(),this.nameValid)if(n["name"]=this.name.trim(),this.siteValid)if(n["site"]=this.site.trim(),this.urlValid){n["url"]=this.url.trim();var a=f["a"].apiAjaxPost;this.channelId&&(e="".concat(e).concat(this.channelId,"/"),a=f["a"].apiAjaxPut),a(e,n,(function(e){0===e.code?t.$emit("channel-saved"):t.channelSaveFailed("通道信息保存失败(".concat(e.code,"): ").concat(e.message))}),s["a"].defaultApiErrorHandler(e,""))}else this.channelSaveFailed("通道URL不能为空！");else this.channelSaveFailed("通道位置不能为空！");else this.channelSaveFailed("通道名称不能为空！");else this.channelSaveFailed("通道ID为32位16进制数字！");else this.channelSaveFailed("请选择正确的通道号")},clearFields:function(){this.cno="",this.cid="",this.name="",this.site="",this.url=""},loadChannel:function(){var t=this,e="channel/channels/".concat(this.channelId,"/");f["a"].apiAjaxGet(e,{},(function(e){0===e.code?(t.cno=e.data.cno,t.cid=e.data.cid,t.name=e.data.name,t.site=e.data.site,t.url=e.data.url):alert("通道信息加载失败(".concat(e.code,"): ").concat(e.message))}),s["a"].defaultApiErrorHandler(e,""))},initChannelData:function(){this.channelId?this.loadChannel():(this.clearFields(),this.cno=this.freeNos[0],this.cid=this.getNewId())},getNewId:function(){var t=new p.a;return t.append("survmanage"),t.append((new Date).getTime().toString()),t.end()}},watch:{channelId:function(t){this.initChannelData()},freeNos:function(){this.initChannelData()}},mounted:function(){}},m=g,v=(n("2e2d"),n("2877")),w=Object(v["a"])(m,d,u,!1,null,null,null),y=w.exports,C=function(){var t=this,e=t._self._c;return e("div",[e("SimpleModalDlg",{attrs:{modalId:t.modalId,title:"删除通道",content:"所有该通道产生的报警信息都会被删除。确认删除通道（".concat(t.cno,"）吗？"),defaultButtonText:"取消",button2Text:"确认",button2Action:t.button2Action,dialogWidth:500}}),e("Toast",{attrs:{toastId:t.toastId,text:"通道删除成功！"}})],1)},S=[],I=n("8cbb"),_={name:"ChannelDeleteDlg",components:{SimpleModalDlg:h["a"]},data:function(){return{toastId:s["a"].randomId("toast")}},props:{modalId:{type:String,required:!0},channelId:{type:Number,required:!0},cno:{type:Number,required:!0}},computed:{},methods:{button2Action:function(){var t=this,e="channel/channels/".concat(this.channelId,"/"),n={};f["a"].apiAjaxDelete(e,n,(function(){I["a"].showToast(t.toastId),t.$emit("channel-deleted")}),s["a"].defaultApiErrorHandler(e,""))}},watch:{},mounted:function(){}},D=_,x=Object(v["a"])(D,C,S,!1,null,null,null),A=x.exports;window.channelRowSelected=function(t,e,n){window.currRowChannelId=t,window.currRowChannelNo=e,window.currRowChannelName=n};var T={name:"ModuleChConfig",components:{ApiDataTable:r["a"],ChannelEditDlg:y,ChannelDeleteDlg:A},data:function(){return{toastId:s["a"].randomId("toast"),toastText:"",iconDacha:!1,channelListTableId:s["a"].randomId("tableId"),channelEditDlgId:s["a"].randomId("modalId"),channelDeleteDlgId:s["a"].randomId("modalId"),tableComp:null,currRowChannelId:0,currRowChannelNo:0,currRowChannelName:"",freeNos:[1,2,3,4,5,6,7,8],usedNos:[]}},computed:{tableHandlers:function(){return{setComponent:this.tableSetComponent,getEndpoint:this.tableGetEndPoint,getParams:this.tableGetParams,tableRowFormatter:this.tableRowFormatter,getColSpecs:this.tableGetColSpecs,rowStyle:this.rowStyle,getDataList:this.getDataList,onPageLoaded:this.onPageLoaded}},availNos:function(){var t=[].concat(Object(i["a"])(this.freeNos),Object(i["a"])(this.usedNos));return t.sort()}},methods:{showToast:function(t,e){this.toastText=e,this.iconDacha=t,I["a"].showToast(this.toastId)},onChannelSaveFailed:function(t){this.showToast(!0,t)},onChannelSaved:function(){this.showToast(!1,"通道信息保存成功！"),this.reloadTable(),this.getUsedFreeChannels()},onChannelDeleted:function(){this.reloadTable(),this.getUsedFreeChannels()},onChannelAlgSaved:function(){},tableSetComponent:function(t){this.tableComp=t},tableRowFormatter:function(t){return{id:t.id,cno:t.cno,cid:t.cid,name:t.name,site:t.site,url:t.url,status:"...",operation:'\n          <div style="display:inline;">\n            <a class="icon-anchor" href="javascript:channelRowSelected('.concat(t.id,", ").concat(t.cno,", '").concat(t.name,"');$('#").concat(this.channelEditDlgId,'\').modal(\'show\')">\n              <div class="icon-box-green">\n                <i class="icon iconfont icon-bianji icon-inbox-white"></i>\n              </div>\n            </a>\n            <a class="icon-anchor" href="javascript:channelRowSelected(').concat(t.id,", ").concat(t.cno,", '").concat(t.name,"');$('#").concat(this.channelDeleteDlgId,'\').modal(\'show\')">\n              <div class="icon-box-red">\n                <i class="icon iconfont icon-shanchu icon-inbox-white"></i>\n              </div>\n            </a>\n          </div>\n        ')}},tableGetParams:function(){return{ordering:"cno"}},tableGetEndPoint:function(){return"channel/channels/"},tableGetColSpecs:function(){var t=[{field:"id",title:"ID",visible:!1},{field:"cno",title:"通道编号"},{field:"cid",title:"通道ID"},{field:"name",title:"通道名称"},{field:"site",title:"通道位置"},{field:"url",title:"URL"},{field:"status",title:"&nbsp;&nbsp;&nbsp;状态"},{field:"operation",title:"&nbsp;&nbsp;&nbsp;操作"}];return t},onTableSelectionChanged:function(){},reloadTable:function(){this.tableComp&&this.tableComp.getOnePage(),this.onTableSelectionChanged()},onPageLoaded:function(t,e){var n=this,a="channel/channels/get_real_time_status/?channel_ids=".concat(e.map((function(t){return t.id})).join(","));console.log("onPageLoaded",e,a),f["a"].apiAjaxGet(a,{},(function(t){0===t.code&&e.forEach((function(e,a){e.id in t.data&&n.tableComp.table.bootstrapTable("updateCell",{index:a,field:"status",value:'\n                  <span class="icon iconfont icon-dot" style="color: '.concat(t.data[e.id]?"green":"gray",';"></span>\n                  ').concat(t.data[e.id]?"在线":"离线","\n                ")})}))}),s["a"].defaultApiErrorHandler(a,""))},rowStyle:function(){var t={};return t},getDataList:function(t){return t.data.results},getUsedFreeChannels:function(){var t=this,e="channel/channels/get_used_free_channel_nos/";f["a"].apiAjaxGet(e,{},(function(e){0===e.code&&(t.freeNos=e.data.free_nos,t.usedNos=e.data.used_nos)}),s["a"].defaultApiErrorHandler(e,""))},beforeModalShow:function(){this.currRowChannelId=window.currRowChannelId,this.currRowChannelNo=window.currRowChannelNo,this.currRowChannelName=window.currRowChannelName,console.log("beforeModalShow",this.currRowChannelId,this.currRowChannelNo,this.currRowChannelName)}},mounted:function(){var t=this;c()("#".concat(this.channelEditDlgId)).on("show.bs.modal",(function(e){"relatedTarget"in e?t.currRowChannelId=0:t.beforeModalShow()})),c()("#".concat(this.channelDeleteDlgId)).on("show.bs.modal",(function(){t.beforeModalShow()})),this.getUsedFreeChannels()}},R=T,N=Object(v["a"])(R,a,o,!1,null,null,null);e["default"]=N.exports},"69a0":function(t,e,n){(function(e){t.exports=e()})((function(t){"use strict";var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function n(t,e){var n=t[0],a=t[1],o=t[2],i=t[3];n+=(a&o|~a&i)+e[0]-680876936|0,n=(n<<7|n>>>25)+a|0,i+=(n&a|~n&o)+e[1]-389564586|0,i=(i<<12|i>>>20)+n|0,o+=(i&n|~i&a)+e[2]+606105819|0,o=(o<<17|o>>>15)+i|0,a+=(o&i|~o&n)+e[3]-1044525330|0,a=(a<<22|a>>>10)+o|0,n+=(a&o|~a&i)+e[4]-176418897|0,n=(n<<7|n>>>25)+a|0,i+=(n&a|~n&o)+e[5]+1200080426|0,i=(i<<12|i>>>20)+n|0,o+=(i&n|~i&a)+e[6]-1473231341|0,o=(o<<17|o>>>15)+i|0,a+=(o&i|~o&n)+e[7]-45705983|0,a=(a<<22|a>>>10)+o|0,n+=(a&o|~a&i)+e[8]+1770035416|0,n=(n<<7|n>>>25)+a|0,i+=(n&a|~n&o)+e[9]-1958414417|0,i=(i<<12|i>>>20)+n|0,o+=(i&n|~i&a)+e[10]-42063|0,o=(o<<17|o>>>15)+i|0,a+=(o&i|~o&n)+e[11]-1990404162|0,a=(a<<22|a>>>10)+o|0,n+=(a&o|~a&i)+e[12]+1804603682|0,n=(n<<7|n>>>25)+a|0,i+=(n&a|~n&o)+e[13]-40341101|0,i=(i<<12|i>>>20)+n|0,o+=(i&n|~i&a)+e[14]-1502002290|0,o=(o<<17|o>>>15)+i|0,a+=(o&i|~o&n)+e[15]+1236535329|0,a=(a<<22|a>>>10)+o|0,n+=(a&i|o&~i)+e[1]-165796510|0,n=(n<<5|n>>>27)+a|0,i+=(n&o|a&~o)+e[6]-1069501632|0,i=(i<<9|i>>>23)+n|0,o+=(i&a|n&~a)+e[11]+643717713|0,o=(o<<14|o>>>18)+i|0,a+=(o&n|i&~n)+e[0]-373897302|0,a=(a<<20|a>>>12)+o|0,n+=(a&i|o&~i)+e[5]-701558691|0,n=(n<<5|n>>>27)+a|0,i+=(n&o|a&~o)+e[10]+38016083|0,i=(i<<9|i>>>23)+n|0,o+=(i&a|n&~a)+e[15]-660478335|0,o=(o<<14|o>>>18)+i|0,a+=(o&n|i&~n)+e[4]-405537848|0,a=(a<<20|a>>>12)+o|0,n+=(a&i|o&~i)+e[9]+568446438|0,n=(n<<5|n>>>27)+a|0,i+=(n&o|a&~o)+e[14]-1019803690|0,i=(i<<9|i>>>23)+n|0,o+=(i&a|n&~a)+e[3]-187363961|0,o=(o<<14|o>>>18)+i|0,a+=(o&n|i&~n)+e[8]+1163531501|0,a=(a<<20|a>>>12)+o|0,n+=(a&i|o&~i)+e[13]-1444681467|0,n=(n<<5|n>>>27)+a|0,i+=(n&o|a&~o)+e[2]-51403784|0,i=(i<<9|i>>>23)+n|0,o+=(i&a|n&~a)+e[7]+1735328473|0,o=(o<<14|o>>>18)+i|0,a+=(o&n|i&~n)+e[12]-1926607734|0,a=(a<<20|a>>>12)+o|0,n+=(a^o^i)+e[5]-378558|0,n=(n<<4|n>>>28)+a|0,i+=(n^a^o)+e[8]-2022574463|0,i=(i<<11|i>>>21)+n|0,o+=(i^n^a)+e[11]+1839030562|0,o=(o<<16|o>>>16)+i|0,a+=(o^i^n)+e[14]-35309556|0,a=(a<<23|a>>>9)+o|0,n+=(a^o^i)+e[1]-1530992060|0,n=(n<<4|n>>>28)+a|0,i+=(n^a^o)+e[4]+1272893353|0,i=(i<<11|i>>>21)+n|0,o+=(i^n^a)+e[7]-155497632|0,o=(o<<16|o>>>16)+i|0,a+=(o^i^n)+e[10]-1094730640|0,a=(a<<23|a>>>9)+o|0,n+=(a^o^i)+e[13]+681279174|0,n=(n<<4|n>>>28)+a|0,i+=(n^a^o)+e[0]-358537222|0,i=(i<<11|i>>>21)+n|0,o+=(i^n^a)+e[3]-722521979|0,o=(o<<16|o>>>16)+i|0,a+=(o^i^n)+e[6]+76029189|0,a=(a<<23|a>>>9)+o|0,n+=(a^o^i)+e[9]-640364487|0,n=(n<<4|n>>>28)+a|0,i+=(n^a^o)+e[12]-421815835|0,i=(i<<11|i>>>21)+n|0,o+=(i^n^a)+e[15]+530742520|0,o=(o<<16|o>>>16)+i|0,a+=(o^i^n)+e[2]-995338651|0,a=(a<<23|a>>>9)+o|0,n+=(o^(a|~i))+e[0]-198630844|0,n=(n<<6|n>>>26)+a|0,i+=(a^(n|~o))+e[7]+1126891415|0,i=(i<<10|i>>>22)+n|0,o+=(n^(i|~a))+e[14]-1416354905|0,o=(o<<15|o>>>17)+i|0,a+=(i^(o|~n))+e[5]-57434055|0,a=(a<<21|a>>>11)+o|0,n+=(o^(a|~i))+e[12]+1700485571|0,n=(n<<6|n>>>26)+a|0,i+=(a^(n|~o))+e[3]-1894986606|0,i=(i<<10|i>>>22)+n|0,o+=(n^(i|~a))+e[10]-1051523|0,o=(o<<15|o>>>17)+i|0,a+=(i^(o|~n))+e[1]-2054922799|0,a=(a<<21|a>>>11)+o|0,n+=(o^(a|~i))+e[8]+1873313359|0,n=(n<<6|n>>>26)+a|0,i+=(a^(n|~o))+e[15]-30611744|0,i=(i<<10|i>>>22)+n|0,o+=(n^(i|~a))+e[6]-1560198380|0,o=(o<<15|o>>>17)+i|0,a+=(i^(o|~n))+e[13]+1309151649|0,a=(a<<21|a>>>11)+o|0,n+=(o^(a|~i))+e[4]-145523070|0,n=(n<<6|n>>>26)+a|0,i+=(a^(n|~o))+e[11]-1120210379|0,i=(i<<10|i>>>22)+n|0,o+=(n^(i|~a))+e[2]+718787259|0,o=(o<<15|o>>>17)+i|0,a+=(i^(o|~n))+e[9]-343485551|0,a=(a<<21|a>>>11)+o|0,t[0]=n+t[0]|0,t[1]=a+t[1]|0,t[2]=o+t[2]|0,t[3]=i+t[3]|0}function a(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}function o(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t[e]+(t[e+1]<<8)+(t[e+2]<<16)+(t[e+3]<<24);return n}function i(t){var e,o,i,r,s,l,c=t.length,d=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=c;e+=64)n(d,a(t.substring(e-64,e)));for(t=t.substring(e-64),o=t.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<o;e+=1)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(n(d,i),e=0;e<16;e+=1)i[e]=0;return r=8*c,r=r.toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(r[2],16),l=parseInt(r[1],16)||0,i[14]=s,i[15]=l,n(d,i),d}function r(t){var e,a,i,r,s,l,c=t.length,d=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=c;e+=64)n(d,o(t.subarray(e-64,e)));for(t=e-64<c?t.subarray(e-64):new Uint8Array(0),a=t.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<a;e+=1)i[e>>2]|=t[e]<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(n(d,i),e=0;e<16;e+=1)i[e]=0;return r=8*c,r=r.toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(r[2],16),l=parseInt(r[1],16)||0,i[14]=s,i[15]=l,n(d,i),d}function s(t){var n,a="";for(n=0;n<4;n+=1)a+=e[t>>8*n+4&15]+e[t>>8*n&15];return a}function l(t){var e;for(e=0;e<t.length;e+=1)t[e]=s(t[e]);return t.join("")}function c(t){return/[\u0080-\uFFFF]/.test(t)&&(t=unescape(encodeURIComponent(t))),t}function d(t,e){var n,a=t.length,o=new ArrayBuffer(a),i=new Uint8Array(o);for(n=0;n<a;n+=1)i[n]=t.charCodeAt(n);return e?i:o}function u(t){return String.fromCharCode.apply(null,new Uint8Array(t))}function h(t,e,n){var a=new Uint8Array(t.byteLength+e.byteLength);return a.set(new Uint8Array(t)),a.set(new Uint8Array(e),t.byteLength),n?a:a.buffer}function f(t){var e,n=[],a=t.length;for(e=0;e<a-1;e+=2)n.push(parseInt(t.substr(e,2),16));return String.fromCharCode.apply(String,n)}function b(){this.reset()}return"5d41402abc4b2a76b9719d911017c592"!==l(i("hello"))&&function(t,e){var n=(65535&t)+(65535&e),a=(t>>16)+(e>>16)+(n>>16);return a<<16|65535&n},"undefined"===typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function e(t,e){return t=0|t||0,t<0?Math.max(t+e,0):Math.min(t,e)}ArrayBuffer.prototype.slice=function(n,a){var o,i,r,s,l=this.byteLength,c=e(n,l),d=l;return a!==t&&(d=e(a,l)),c>d?new ArrayBuffer(0):(o=d-c,i=new ArrayBuffer(o),r=new Uint8Array(i),s=new Uint8Array(this,c,o),r.set(s),i)}}(),b.prototype.append=function(t){return this.appendBinary(c(t)),this},b.prototype.appendBinary=function(t){this._buff+=t,this._length+=t.length;var e,o=this._buff.length;for(e=64;e<=o;e+=64)n(this._hash,a(this._buff.substring(e-64,e)));return this._buff=this._buff.substring(e-64),this},b.prototype.end=function(t){var e,n,a=this._buff,o=a.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<o;e+=1)i[e>>2]|=a.charCodeAt(e)<<(e%4<<3);return this._finish(i,o),n=l(this._hash),t&&(n=f(n)),this.reset(),n},b.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},b.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},b.prototype.setState=function(t){return this._buff=t.buff,this._length=t.length,this._hash=t.hash,this},b.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},b.prototype._finish=function(t,e){var a,o,i,r=e;if(t[r>>2]|=128<<(r%4<<3),r>55)for(n(this._hash,t),r=0;r<16;r+=1)t[r]=0;a=8*this._length,a=a.toString(16).match(/(.*?)(.{0,8})$/),o=parseInt(a[2],16),i=parseInt(a[1],16)||0,t[14]=o,t[15]=i,n(this._hash,t)},b.hash=function(t,e){return b.hashBinary(c(t),e)},b.hashBinary=function(t,e){var n=i(t),a=l(n);return e?f(a):a},b.ArrayBuffer=function(){this.reset()},b.ArrayBuffer.prototype.append=function(t){var e,a=h(this._buff.buffer,t,!0),i=a.length;for(this._length+=t.byteLength,e=64;e<=i;e+=64)n(this._hash,o(a.subarray(e-64,e)));return this._buff=e-64<i?new Uint8Array(a.buffer.slice(e-64)):new Uint8Array(0),this},b.ArrayBuffer.prototype.end=function(t){var e,n,a=this._buff,o=a.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<o;e+=1)i[e>>2]|=a[e]<<(e%4<<3);return this._finish(i,o),n=l(this._hash),t&&(n=f(n)),this.reset(),n},b.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},b.ArrayBuffer.prototype.getState=function(){var t=b.prototype.getState.call(this);return t.buff=u(t.buff),t},b.ArrayBuffer.prototype.setState=function(t){return t.buff=d(t.buff,!0),b.prototype.setState.call(this,t)},b.ArrayBuffer.prototype.destroy=b.prototype.destroy,b.ArrayBuffer.prototype._finish=b.prototype._finish,b.ArrayBuffer.hash=function(t,e){var n=r(new Uint8Array(t)),a=l(n);return e?f(a):a},b}))},"6b54":function(t,e,n){"use strict";n("3846");var a=n("cb7c"),o=n("0bfb"),i=n("9e1e"),r="toString",s=/./[r],l=function(t){n("2aba")(RegExp.prototype,r,t,!0)};n("79e5")((function(){return"/a/b"!=s.call({source:"a",flags:"b"})}))?l((function(){var t=a(this);return"/".concat(t.source,"/","flags"in t?t.flags:!i&&t instanceof RegExp?o.call(t):void 0)})):s.name!=r&&l((function(){return s.call(this)}))},b1e1:function(t,e,n){},f217:function(t,e,n){"use strict";var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container-fluid w-100 overflow-auto"},[e("table",{staticClass:"text-nowrap",attrs:{id:t.tableId,"data-height":t.dataHeight,"data-classes":"table table-striped table-sm","data-sortable":"true","data-click-to-select":"true","data-pagination":t.pagination,"data-side-pagination":"server","data-detail-view":t.detailView,"data-detail-view-icon":"true","data-detail-view-by-click":"true","data-show-footer":t.showFooter}})])},o=[],i=(n("8e6e"),n("456d"),n("2909")),r=(n("ac6a"),n("7514"),n("ade3")),s=(n("c5f6"),{transCellSelected2ItemSelected:function(t,e,n,a){var o=0,i=null;a&&(o=a.id,i=a),"selectedId"in t&&(t.selectedId=o),"selectedRow"in t&&(t.selectedRow=i),t.$emit("itemSelected",o,i)}}),l=n("1157"),c=n.n(l),d=n("0be2"),u={formatLoadingMessage:function(){return"数据加载中..."},formatRecordsPerPage:function(t){return t+"行每页"},formatShowingRows:function(t,e,n){return"第"+t+"-"+e+"行，总共"+n+"行"},formatSRPaginationPreText:function(){return"上一页"},formatSRPaginationPageText:function(t){return"跳转至"+t},formatSRPaginationNextText:function(){return"下一页"},formatDetailPagination:function(t){return"总计："+t},formatSearch:function(){return"搜索"},formatClearSearch:function(){return"清除搜索"},formatNoMatches:function(){return"未查询到相关记录"},formatPaginationSwitch:function(){return"隐藏显示分页"},formatPaginationSwitchDown:function(){return"显示分页"},formatPaginationSwitchUp:function(){return"隐藏分页"},formatRefresh:function(){return"刷新"},formatToggle:function(){return"展开"},formatToggleOn:function(){return"显示卡片视图"},formatToggleOff:function(){return"隐藏卡片视图"},formatColumns:function(){return"列视图"},formatColumnsToggleAll:function(){return"Toggle all"},formatFullscreen:function(){return"全屏"},formatAllRows:function(){return"全部"}};function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var b={name:"ApiDataTable",components:{},data:function(){return{table:null,listSize:10,listOffset:0,searchText:"",sortOrder:"",sortField:"",timeoutIdReload:0,selectedIds:[],selectedRows:[]}},props:{tableId:{type:String,required:!1,default:"api_data_table"},handlers:{type:Object,required:!0},dataHeight:{type:Number,required:!1,default:500},loadData:{type:Boolean,required:!1,default:!0},inModal:{type:Boolean,required:!1,default:!1},showSearch:{type:Boolean,required:!1,default:!0},showFooter:{type:Boolean,required:!1,default:!1},detailView:{type:Boolean,required:!1,default:!0},pagination:{type:Boolean,required:!1,default:!0},checkbox:{type:Boolean,required:!1,default:!1}},methods:{detailFormatter:function(t,e){return"undefined"===typeof this.handlers.detailFormatter?this.defaultDetailFormatter(t,e):this.handlers.detailFormatter(t,e)},rowStyle:function(t,e){return"undefined"===typeof this.handlers.rowStyle?{}:this.handlers.rowStyle(t,e)},defaultDetailFormatter:function(t,e){var n=[];n.push('<div class="text-left"><pre>');var a=JSON.stringify(e,null,4);return n.push(a),n.push("</pre></div>"),n.join("")},getOnePage:function(){var t=this,e=this.handlers.getEndpoint();if(e){var n={limit:this.listSize,offset:this.listOffset,search:this.searchText,order:this.sortOrder,order_field:this.sortField};if(Object.assign(n,this.getSortParam()),"getParams"in this.handlers&&this.handlers.getParams){var a=this.handlers.getParams();a&&(n=f(f({},n),a))}d["a"].apiAjaxGet(e,n,(function(e){if(0===e.code){var n=e.data,a=t.handlers.getDataList?t.handlers.getDataList(e):n.rows,o=[];for(var i in a){var r=t.handlers.tableRowFormatter(a[i],i,t);o.push(r)}t.table.bootstrapTable("load",o),t.table.bootstrapTable("refreshOptions",{totalRows:n.count}),t.handlers.onPageLoaded&&t.handlers.onPageLoaded(t,o)}else console.log("Got getOnePage error: "),console.log(e.data)}),(function(t){console.log(t)}),(function(){t.onTableSelectionChanged(),t.onTableDblClickCell(null,null,null,null)}))}},onSearch:function(t,e){this.searchText=e,console.log("onSearch",e)},onPageChange:function(t,e,n){console.log("onPageChange: ",e,n),this.listSize=n,this.listOffset=(e-1)*this.listSize,this.searchText=this.table.bootstrapTable("getOptions").searchText,this.getOnePage()},getSortParam:function(){var t=this.table.bootstrapTable("getOptions"),e=t.sortName,n=t.sortOrder;if(t.sortName)e=t.sortName,n=t.sortOrder;else{var a=t.columns[0].find((function(t){return"default-sort-order"in t}));if(!a)return{};e=a.field,n=a["default-sort-order"]}var o=e,i=t.columns[0].find((function(t){return t.field===e}));return"sort-name"in i&&(o=i["sort-name"]),o={asc:"",desc:"-"}[n]+o,console.log("onSort: ".concat(e,", ").concat(n,", ").concat(o),t),{ordering:o}},onTableDblClickCell:function(t,e,n,a){this.$emit("cellSelected",e,n,a)},getRowIndex:function(t,e){var n=-1,a=this.table.bootstrapTable("getData");return a.forEach((function(a,o){a[t]===e&&(n=o)})),n},refreshSelectedRow:function(t,e,n){var a=this.getRowIndex(t,e);a>=0&&this.table.bootstrapTable("showRow",{index:a});var o=this.getRowIndex(t,n);o>=0&&this.table.bootstrapTable("showRow",{index:o})},delayToReleadTable:function(t){var e=this;this.timeoutIdReload&&(clearTimeout(this.timeoutIdReload),this.timeoutIdReload=0),t&&(this.listOffset=0),this.timeoutIdReload=setTimeout((function(){e.timeoutIdReload=0,e.getOnePage()}),500)},onTableSelectionChanged:function(){this.selectedRows=this.table.bootstrapTable("getSelections"),this.selectedIds=this.selectedRows.map((function(t){return t.id})),this.$emit("selection-changed",this.selectedIds,this.selectedRows)},setEventForCheckbox:function(){this.checkbox&&(this.table.on("check.bs.table",this.onTableSelectionChanged),this.table.on("uncheck.bs.table",this.onTableSelectionChanged),this.table.on("check-all.bs.table",this.onTableSelectionChanged),this.table.on("uncheck-all.bs.table",this.onTableSelectionChanged))}},computed:{},watch:{loadData:function(t){t&&this.getOnePage()},checkbox:function(){this.setEventForCheckbox()}},mounted:function(){this.handlers.setComponent(this);var t=this.handlers.getColSpecs();this.checkbox&&(t=[{field:"selected",checkbox:!0,default:!1}].concat(Object(i["a"])(t)));var e=c()("#".concat(this.tableId));this.table=e,e.bootstrapTable(f({columns:t,pageNumber:1,pageSize:this.listSize,pageList:"[10, 20, 50, 100]",paginationHAlign:"right",paginationDetailHAlign:"left",detailFormatter:this.detailFormatter,rowStyle:this.rowStyle,search:this.showSearch,showJumpTo:!0},u)),e.on("reset-view.bs.table",(function(t,e){c()("div.bootstrap-table button").addClass("btn-sm"),c()("div.bootstrap-table button").addClass("btn-iview-size"),c()("div.bootstrap-table .page-jump-to > input").css("font-size","12px")})),e.on("search.bs.table",this.onSearch),e.on("sort.bs.table",this.getOnePage),e.on("page-change.bs.table",this.onPageChange),e.on("dbl-click-cell.bs.table",this.onTableDblClickCell),this.setEventForCheckbox(),this.loadData&&this.getOnePage()},transCellSelected2ItemSelected:function(t,e,n,a){s.transCellSelected2ItemSelected(t,e,n,a)}},p=b,g=n("2877"),m=Object(g["a"])(p,a,o,!1,null,"a27096d2",null);e["a"]=m.exports}}]);