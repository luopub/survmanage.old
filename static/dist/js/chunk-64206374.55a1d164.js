(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-64206374"],{4447:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container-fluid"},[e("div",{staticClass:"row w-100 ml-1 my-2"},[e("div",{staticClass:"row ml-1 my-2"},[e("button",{staticClass:"btn btn-primary",attrs:{"data-toggle":"modal","data-target":"#"+t.channelEditDlgId}},[t._v("添加通道")]),e("button",{staticClass:"btn btn-light ml-4",attrs:{disabled:!0}},[t._v("已用通道 "+t._s(t.usedNos.length)+"/"+t._s(t.availNos.length))])]),e("div",{staticClass:"row w-100"},[e("ApiDataTable",{attrs:{handlers:t.tableHandlers,tableId:"channelListTableId",dataHeight:400,showWaitingDlg:!1,showSearch:!1,detailView:!1}})],1),e("ChannelEditDlg",{attrs:{modalId:t.channelEditDlgId,channelId:t.currRowChannelId,availNos:t.availNos},on:{"channel-saved":t.onChannelSaved}}),e("ChannelDeleteDlg",{attrs:{modalId:t.channelDeleteDlgId,channelId:t.currRowChannelId,cno:t.currRowChannelNo},on:{"channel-deleted":t.onChannelDeleted}}),e("ChannelAlgConfigDlg",{attrs:{modalId:t.channelAlgConfigDlgId,channelId:t.currRowChannelId,cno:t.currRowChannelNo,channelName:t.currRowChannelName},on:{"channel-deleted":t.onChannelAlgSaved}})],1)])},o=[],l=(a("ac6a"),a("7f7f"),a("55dd"),a("75fc")),i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container-fluid w-100 overflow-auto"},[e("table",{staticClass:"text-nowrap",attrs:{id:t.tableId,"data-height":t.dataHeight,"data-classes":"table table-striped table-sm","data-sortable":"true","data-click-to-select":"true","data-pagination":t.pagination,"data-side-pagination":"server","data-detail-view":t.detailView,"data-detail-view-icon":"true","data-detail-view-by-click":"true","data-show-footer":t.showFooter}})])},s=[],r=(a("8e6e"),a("456d"),a("7514"),a("bd86")),c=(a("c5f6"),{transCellSelected2ItemSelected:function(t,e,a,n){var o=0,l=null;n&&(o=n.id,l=n),"selectedId"in t&&(t.selectedId=o),"selectedRow"in t&&(t.selectedRow=l),t.$emit("itemSelected",o,l)}}),d=a("1157"),u=a.n(d),h=a("0be2");function m(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function f(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?m(Object(a),!0).forEach((function(e){Object(r["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var g={name:"ApiDataTable",components:{},data:function(){return{table:null,listSize:10,listOffset:0,searchText:"",sortOrder:"",sortField:"",timeoutIdReload:0,selectedIds:[],selectedRows:[]}},props:{tableId:{type:String,required:!1,default:"api_data_table"},handlers:{type:Object,required:!0},dataHeight:{type:Number,required:!1,default:500},loadData:{type:Boolean,required:!1,default:!0},inModal:{type:Boolean,required:!1,default:!1},showSearch:{type:Boolean,required:!1,default:!0},showFooter:{type:Boolean,required:!1,default:!1},detailView:{type:Boolean,required:!1,default:!0},pagination:{type:Boolean,required:!1,default:!0},checkbox:{type:Boolean,required:!1,default:!1}},methods:{detailFormatter:function(t,e){return"undefined"===typeof this.handlers.detailFormatter?this.defaultDetailFormatter(t,e):this.handlers.detailFormatter(t,e)},rowStyle:function(t,e){return"undefined"===typeof this.handlers.rowStyle?{}:this.handlers.rowStyle(t,e)},defaultDetailFormatter:function(t,e){var a=[];a.push('<div class="text-left"><pre>');var n=JSON.stringify(e,null,4);return a.push(n),a.push("</pre></div>"),a.join("")},getOnePage:function(){var t=this;console.log("getOnePage");var e=this.handlers.getEndpoint();if(e){var a={limit:this.listSize,offset:this.listOffset,search:this.searchText,order:this.sortOrder,order_field:this.sortField};if(Object.assign(a,this.getSortParam()),"getParams"in this.handlers&&this.handlers.getParams){var n=this.handlers.getParams();n&&(a=f(f({},a),n))}h["a"].apiAjaxGet(e,a,(function(e){if(0===e.code){var a=e.data,n=t.handlers.getDataList?t.handlers.getDataList(e):a.rows,o=[];for(var l in n){var i=t.handlers.tableRowFormatter(n[l],l,t);o.push(i)}t.table.bootstrapTable("load",o),t.table.bootstrapTable("refreshOptions",{totalRows:a.count}),t.handlers.onPageLoaded&&t.handlers.onPageLoaded(t,o)}else console.log("Got getOnePage error: "),console.log(e.data)}),(function(t){console.log(t)}),(function(){t.onTableSelectionChanged(),t.onTableDblClickCell(null,null,null,null)}))}},onSearch:function(t,e){this.searchText=e,console.log("onSearch",e)},onPageChange:function(t,e,a){console.log("onPageChange: ",e,a),this.listSize=a,this.listOffset=(e-1)*this.listSize,this.searchText=this.table.bootstrapTable("getOptions").searchText,this.getOnePage()},getSortParam:function(){var t=this.table.bootstrapTable("getOptions"),e=t.sortName,a=t.sortOrder;if(t.sortName)e=t.sortName,a=t.sortOrder;else{var n=t.columns[0].find((function(t){return"default-sort-order"in t}));if(!n)return{};e=n.field,a=n["default-sort-order"]}var o=e,l=t.columns[0].find((function(t){return t.field===e}));return"sort-name"in l&&(o=l["sort-name"]),o={asc:"",desc:"-"}[a]+o,console.log("onSort: ".concat(e,", ").concat(a,", ").concat(o),t),{ordering:o}},onTableDblClickCell:function(t,e,a,n){console.log("cellSelected",e,a),this.$emit("cellSelected",e,a,n)},getRowIndex:function(t,e){var a=-1,n=this.table.bootstrapTable("getData");return n.forEach((function(n,o){n[t]===e&&(a=o)})),a},refreshSelectedRow:function(t,e,a){var n=this.getRowIndex(t,e);n>=0&&this.table.bootstrapTable("showRow",{index:n});var o=this.getRowIndex(t,a);o>=0&&this.table.bootstrapTable("showRow",{index:o})},delayToReleadTable:function(t){var e=this;this.timeoutIdReload&&(clearTimeout(this.timeoutIdReload),this.timeoutIdReload=0),t&&(this.listOffset=0),this.timeoutIdReload=setTimeout((function(){e.timeoutIdReload=0,e.getOnePage()}),500)},onTableSelectionChanged:function(){this.selectedRows=this.table.bootstrapTable("getSelections"),this.selectedIds=this.selectedRows.map((function(t){return t.id})),console.log("onTableSelectionChanged: (".concat(this.selectedIds.length,"): ").concat(this.selectedIds)),this.$emit("selection-changed",this.selectedIds,this.selectedRows)},setEventForCheckbox:function(){this.checkbox&&(this.table.on("check.bs.table",this.onTableSelectionChanged),this.table.on("uncheck.bs.table",this.onTableSelectionChanged),this.table.on("check-all.bs.table",this.onTableSelectionChanged),this.table.on("uncheck-all.bs.table",this.onTableSelectionChanged))}},computed:{},watch:{loadData:function(t){t&&this.getOnePage()},checkbox:function(){this.setEventForCheckbox()}},mounted:function(){this.handlers.setComponent(this);var t=this.handlers.getColSpecs();this.checkbox&&(t=[{field:"selected",checkbox:!0,default:!1}].concat(Object(l["a"])(t)));var e=u()("#".concat(this.tableId));this.table=e,console.log("this.table",this.table,e),e.bootstrapTable({columns:t,pageNumber:1,pageSize:this.listSize,pageList:"[10, 20, 50, 100]",paginationHAlign:"right",paginationDetailHAlign:"left",detailFormatter:this.detailFormatter,rowStyle:this.rowStyle,search:this.showSearch,showJumpTo:!0}),e.on("search.bs.table",this.onSearch),e.on("sort.bs.table",this.getOnePage),e.on("page-change.bs.table",this.onPageChange),e.on("dbl-click-cell.bs.table",this.onTableDblClickCell),this.setEventForCheckbox(),this.loadData&&this.getOnePage()},transCellSelected2ItemSelected:function(t,e,a,n){c.transCellSelected2ItemSelected(t,e,a,n)}},b=g,p=a("2877"),v=Object(p["a"])(b,i,s,!1,null,"4548f32c",null),w=v.exports,C=a("fa7d"),y=function(){var t=this,e=t._self._c;return e("SimpleModalDlg",{attrs:{modalId:t.modalId,title:t.channelId?"编辑通道":"添加通道",content:"",defaultButtonText:"取消",button2Text:"保存",button2Action:t.button2Action,dialogWidth:600},scopedSlots:t._u([{key:"bodyPost",fn:function(){return[e("div",{staticClass:"container-fluid"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-3"},[e("span",{staticClass:"field-label field-required"},[t._v("通道号")])]),e("div",{staticClass:"col mb-1"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.cno,expression:"cno"}],attrs:{name:"selectList"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.cno=e.target.multiple?a:a[0]}}},t._l(t.availNos,(function(a){return e("option",{key:t.modalId+a},[t._v(t._s(a))])})),0),e("IconFont",{class:t.cnoValid?"dagou-icon":"dacha-icon",attrs:{iconName:t.cnoValid?"icon-dagouyouquan":"icon-cuowuguanbiquxiao-yuankuang"}})],1)]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-3"},[e("span",{staticClass:"field-label field-required"},[t._v("通道ID")])]),e("div",{staticClass:"col mb-1"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.cid,expression:"cid"}],staticClass:"mr-1",staticStyle:{width:"20em"},domProps:{value:t.cid},on:{input:function(e){e.target.composing||(t.cid=e.target.value)}}}),e("IconFont",{class:t.cidValid?"dagou-icon":"dacha-icon",attrs:{iconName:t.cidValid?"icon-dagouyouquan":"icon-cuowuguanbiquxiao-yuankuang"}})],1)]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-3"},[e("span",{staticClass:"field-label field-required"},[t._v("通道名称")])]),e("div",{staticClass:"col mb-1"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"mr-1",staticStyle:{width:"20em"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}}),e("IconFont",{class:t.nameValid?"dagou-icon":"dacha-icon",attrs:{iconName:t.nameValid?"icon-dagouyouquan":"icon-cuowuguanbiquxiao-yuankuang"}})],1)]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-3"},[e("span",{staticClass:"field-label field-required"},[t._v("通道位置")])]),e("div",{staticClass:"col mb-1"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.site,expression:"site"}],staticClass:"mr-1",staticStyle:{width:"20em"},domProps:{value:t.site},on:{input:function(e){e.target.composing||(t.site=e.target.value)}}}),e("IconFont",{class:t.siteValid?"dagou-icon":"dacha-icon",attrs:{iconName:t.siteValid?"icon-dagouyouquan":"icon-cuowuguanbiquxiao-yuankuang"}})],1)]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-3"},[e("span",{staticClass:"field-label field-required"},[t._v("URL")])]),e("div",{staticClass:"col mb-1"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.url,expression:"url"}],staticClass:"mr-1",staticStyle:{width:"20em"},domProps:{value:t.url},on:{input:function(e){e.target.composing||(t.url=e.target.value)}}}),e("IconFont",{class:t.urlValid?"dagou-icon":"dacha-icon",attrs:{iconName:t.urlValid?"icon-dagouyouquan":"icon-cuowuguanbiquxiao-yuankuang"}})],1)])])]},proxy:!0}])})},I=[],S=function(){var t=this,e=t._self._c;return e("ModalDlgFrame",{attrs:{modalId:t.modalId,dialogWidth:t.dialogWidth,titleBg:t.titleBg},scopedSlots:t._u([{key:"title",fn:function(){return[t._v("\n    "+t._s(t.title)+"\n  ")]},proxy:!0},{key:"body",fn:function(){return[t._t("bodyPre"),t.content.length>0?e("pre",{staticClass:"text-left"},[t._v(t._s(t.content))]):t._e(),t._t("bodyPost")]},proxy:!0},{key:"footer",fn:function(){return[t._t("footerPre"),e("button",{directives:[{name:"show",rawName:"v-show",value:!!t.defaultButtonText,expression:"!!defaultButtonText"}],staticClass:"btn btn-default btn-primary",attrs:{type:"button","data-dismiss":"modal"},on:{click:t.defaultButtonAction}},[t._v("\n      "+t._s(t.defaultButtonText)+"\n    ")]),t.button2Text?e("button",{staticClass:"btn btn-outline-primary",attrs:{type:"button","data-dismiss":"modal"},on:{click:t.button2Action}},[t._v("\n      "+t._s(t.button2Text)+"\n    ")]):t._e(),t.button3Text?e("button",{staticClass:"btn btn-outline-primary",attrs:{type:"button","data-dismiss":"modal"},on:{click:t.button3Action}},[t._v("\n      "+t._s(t.button3Text)+"\n    ")]):t._e(),t._t("footerPost")]},proxy:!0}],null,!0)})},x=[],A=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container-fluid"},[e("div",{staticClass:"modal fade modal-open",attrs:{"data-backdrop":"static",id:t.modalId,tabindex:"-1",role:"dialog"}},[e("div",{staticClass:"modal-dialog draggable align-self-center",attrs:{role:"document"}},[e("div",{staticClass:"modal-content",style:t.contentStyle},[e("div",{class:"modal-header panel-heading py-2 "+t.titleBg},[e("h4",{staticClass:"modal-title"},[t._t("title")],2),t.showClose?e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])]):t._e()]),e("div",{staticClass:"modal-body"},[t._t("body")],2),e("div",{staticClass:"modal-footer"},[t._t("footer")],2)])])])])},D=[],_={name:"ModalDlgFrame",props:{modalId:{type:String,required:!0},titleBg:{type:String,required:!1,default:"bg-primary"},dialogWidth:{type:Number,required:!1,default:800},showClose:{type:Boolean,required:!1,default:!0}},data:function(){return{}},methods:{modalCenter:function(){var t=u()("#".concat(this.modalId," ")+".modal-dialog");if(t.is(":visible")){u()("#".concat(this.modalId)).css("display","block");var e=u()("#".concat(this.modalId," ")+".modal-content"),a=e.outerHeight(!0),n=e.outerWidth(!0),o=u()(window).height()/2-a/2;o<10&&(o=10),t.css("margin-top",o+"px");var l=u()(window).width()/2-n/2;t.css("margin-left",l+"px")}}},computed:{contentStyle:function(){return{width:this.dialogWidth+"px"}}},created:function(){},mounted:function(){u()("#".concat(this.modalId)).on("shown.bs.modal",this.modalCenter),u()(window).on("resize",this.modalCenter)}},O=_,P=Object(p["a"])(O,A,D,!1,null,"965a40b6",null),T=P.exports,N={name:"SimpleModalDlg",components:{ModalDlgFrame:T},data:function(){return{}},props:{modalId:{type:String,required:!0},titleBg:{type:String,required:!1,default:"bg-primary"},defaultButtonText:{type:String,required:!1,default:"Close"},defaultButtonAction:{type:Function,required:!1,default:function(){}},button2Text:{type:String,required:!1,default:""},button2Action:{type:Function,required:!1,default:function(){}},button3Text:{type:String,required:!1,default:""},button3Action:{type:Function,required:!1,default:function(){}},title:{type:String,required:!1,default:"Simple Dialog"},content:{type:String,required:!1,default:""},dialogWidth:{type:Number,required:!1,default:600}},mounted:function(){}},j=N,R=Object(p["a"])(j,S,x,!1,null,null,null),q=R.exports,k={name:"ChannelEditDlg",components:{SimpleModalDlg:q},data:function(){return{cno:"",cid:"",name:"",site:"",url:""}},props:{modalId:{type:String,required:!0},channelId:{type:Number,required:!0},availNos:{type:Array,required:!0}},computed:{cnoValid:function(){return!!this.cno},cidValid:function(){return 32===this.cid.trim().length},nameValid:function(){return this.name.trim().length>0},siteValid:function(){return this.site.length>0},urlValid:function(){return this.url.length>=10}},methods:{button2Action:function(){var t=this,e="channel/channels/",a={};if(this.cnoValid)if(a["cno"]=this.cno,this.cidValid)if(a["cid"]=this.cid.trim(),this.nameValid)if(a["name"]=this.name.trim(),this.siteValid)if(a["site"]=this.site.trim(),this.urlValid){a["url"]=this.url.trim();var n=h["a"].apiAjaxPost;this.channelId&&(e="".concat(e).concat(this.channelId,"/"),n=h["a"].apiAjaxPut),n(e,a,(function(e){0===e.code?(alert("通道信息保存成功！"),t.$emit("channel-saved")):alert("通道信息保存失败(".concat(e.code,"): ").concat(e.message))}),C["a"].defaultApiErrorHandler(e,""))}else alert("通道URL不能为空！");else alert("通道位置不能为空！");else alert("通道名称不能为空！");else alert("通道ID为32位16进制数字！");else alert("请选择正确的通道号")},clearFields:function(){this.cno="",this.cid="",this.name="",this.site="",this.url=""},loadChannel:function(){var t=this,e="channel/channels/".concat(this.channelId,"/");h["a"].apiAjaxGet(e,{},(function(e){0===e.code?(t.cno=e.data.cno,t.cid=e.data.cid,t.name=e.data.name,t.site=e.data.site,t.url=e.data.url):alert("通道信息加载失败(".concat(e.code,"): ").concat(e.message))}),C["a"].defaultApiErrorHandler(e,""))}},watch:{channelId:function(t){t?this.loadChannel():this.clearFields()}},mounted:function(){}},F=k,E=Object(p["a"])(F,y,I,!1,null,null,null),V=E.exports,B=function(){var t=this,e=t._self._c;return e("SimpleModalDlg",{attrs:{modalId:t.modalId,title:"删除通道",content:"所有该通道产生的报警信息都会被删除。确认删除通道（".concat(t.cno,"）吗？"),defaultButtonText:"取消",button2Text:"确认",button2Action:t.button2Action,dialogWidth:500}})},L=[],H={name:"ChannelDeleteDlg",components:{SimpleModalDlg:q},data:function(){return{}},props:{modalId:{type:String,required:!0},channelId:{type:Number,required:!0},cno:{type:Number,required:!0}},computed:{},methods:{button2Action:function(){var t=this,e="channel/channels/".concat(this.channelId,"/"),a={};h["a"].apiAjaxDelete(e,a,(function(){alert("通道删除成功成功！"),t.$emit("channel-deleted")}),C["a"].defaultApiErrorHandler(e,""))}},watch:{},mounted:function(){}},M=H,G=Object(p["a"])(M,B,L,!1,null,null,null),W=G.exports,$=function(){var t=this,e=t._self._c;return e("SimpleModalDlg",{attrs:{modalId:t.modalId,title:"算法配置 - 通道 ".concat(t.cno," - ").concat(t.channelName),content:"",defaultButtonText:"取消",button2Text:"确定",button2Action:t.saveStatus,dialogWidth:1100},scopedSlots:t._u([{key:"bodyPost",fn:function(){return[e("div",{staticClass:"container-fluid"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-3"},[e("div",{staticClass:"w-100 overflow-auto border-top border-bottom",staticStyle:{height:"620px"}},[e("div",{staticClass:"list-group",attrs:{id:"list-tab",role:"tablist"}},t._l(Object.keys(t.channelAlgInfo),(function(a,n){return e("a",{key:"alg"+t.modalId+n,class:"list-group-item list-group-item-action "+(0===n?"active":""),attrs:{id:"".concat(t.modalId,"-list-").concat(a),"data-toggle":"list","data-x":a,role:"tab"}},[e("div",{staticClass:"icon-name"},[e("div",{staticClass:"mr-2",staticStyle:{"max-height":"100%",width:"60px"}},[e("img",{attrs:{src:t.channelAlgInfo[a].icon,alt:""}})]),e("div",{staticStyle:{width:"90px"}},[e("p",{staticClass:"mb-1"},[e("b",[t._v(t._s(t.channelAlgInfo[a].name_ch)+"识别")])]),e("p",{staticClass:"my-0"},[e("IconFont",{class:t.channelAlgInfo[a].channelAlgorthm?"dagou-icon":"dacha-icon",attrs:{iconName:t.channelAlgInfo[a].channelAlgorthm?"icon-dagouyouquan":"icon-cuowuguanbiquxiao-yuankuang"}}),t._v("\n                      "+t._s(t.channelAlgInfo[a].channelAlgorthm?"已配置":"未配置")+"\n                    ")],1)])])])})),0)])]),e("div",{staticClass:"col-9 pl-0"},[e("div",{staticClass:"w-100 overflow-auto border-top border-bottom container-fluid",staticStyle:{height:"620px"}},[e("ChannelAlgConfigPanel",{attrs:{algDisplayName:t.channelAlgInfo[t.currAlgName].name_ch,channelImage:t.channelImage,modalShown:t.modalShown,defaultParameters:t.defaultParameters},model:{value:t.algStatus[t.currAlgName],callback:function(e){t.$set(t.algStatus,t.currAlgName,e)},expression:"algStatus[currAlgName]"}})],1)])])])]},proxy:!0}])})},U=[],z=a("8715"),J=a("b84e");function K(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function Q(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?K(Object(a),!0).forEach((function(e){Object(r["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):K(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var X={name:"ChannelAlgConfigDlg",components:{SimpleModalDlg:q,ChannelAlgConfigPanel:J["a"]},data:function(){return{channelAlgInfo:z["a"].getAlgNameIcons(),currAlgName:Object.keys(z["a"].getAlgoritims())[0],algStatus:z["a"].initDefaultAlgStatus(),dateTimeSettingShown:!1,channelImage:"",modalShown:!1,defaultParameters:{}}},props:{modalId:{type:String,required:!0},channelId:{type:Number,required:!0},cno:{type:Number,required:!0},channelName:{type:String,required:!0}},computed:{},methods:{saveStatus:function(){var t=this,e="channel/channels/".concat(this.channelId,"/config_alg/"),a=this.algStatus;h["a"].apiAjaxPost(e,a,(function(e){0===e.code?(alert("通道（".concat(t.cno,"）算法配置保存成功！")),t.$emit("channel-alg-saved")):alert("通道（".concat(t.cno,"）算法配置保存失败(").concat(e.code,"): ").concat(e.message)),t.loadChannelAlgorithms()}),C["a"].defaultApiErrorHandler(e,""))},loadChannelAlgorithms:function(){var t=this,e="channel/channelalgorithms2/?channel=".concat(this.channelId);h["a"].apiAjaxGet(e,{},(function(e){if(0===e.code){for(var a in t.channelAlgInfo)t.channelAlgInfo[a].channelAlgorthm=null;Object.keys(t.channelAlgInfo).forEach((function(e){var a=Q({configured:"0"},t.defaultParameters);t.algStatus[e]=a})),e.data.forEach((function(e){e.algorithm.name in Object.keys(t.channelAlgInfo)?alert("发现不认识的算法: ".concat(e.algorithm.name)):(t.channelAlgInfo[e.algorithm.name].channelAlgorthm=e,t.algStatus[e.algorithm.name]=t.recordToStatus(e))})),console.log("loadChannelAlgorithms2",t.algStatus)}else console.log("获取通道算法失败！")}),C["a"].defaultApiErrorHandler(e,""))},recordToStatus:function(t){var e={};return Object.keys(this.defaultParameters).forEach((function(a){e[a]=t[a]})),e.configured="1",e},loadChannelImage:function(){var t=this;if(this.channelId){var e="channel/channels/".concat(this.channelId,"/get_real_time_image/");h["a"].apiAjaxGet(e,{},(function(e){0===e.code&&e.data&&(t.channelImage=C["a"].getImageUrl(e.data.filename))}),C["a"].defaultApiErrorHandler(e,""))}},loadDefaultParameters:function(){var t=this,e="algorithm/algorithmdefaultparameters/";h["a"].apiAjaxGet(e,{},(function(e){if(0===e.code)if(e.data.length>0)for(var a in t.defaultParameters={},z["a"].defaultAlgParams)t.defaultParameters[a]=e.data[0][a];else t.defaultParameters=Q({},z["a"].defaultAlgParams)}),C["a"].defaultApiErrorHandler(e,""))}},watch:{channelId:function(){this.loadChannelAlgorithms(),this.loadChannelImage()},currAlgName:function(){},algStatus:{handler:function(){},deep:!0}},mounted:function(){var t=this;u()('a[data-toggle="list"]').on("shown.bs.tab",(function(e){t.currAlgName=u()(e.target).attr("data-x")})),u()("#dateTimeSetting").on("hidden.bs.collapse",(function(){t.dateTimeSettingShown=!1})),u()("#dateTimeSetting").on("shown.bs.collapse",(function(){t.dateTimeSettingShown=!0})),u()("#".concat(this.modalId)).on("shown.bs.modal",(function(){t.modalShown=!0})),u()("#".concat(this.modalId)).on("hide.bs.modal",(function(){t.modalShown=!1})),this.loadDefaultParameters()}},Y=X,Z=(a("9761"),Object(p["a"])(Y,$,U,!1,null,null,null)),tt=Z.exports;window.channelRowSelected=function(t,e,a){window.currRowChannelId=t,window.currRowChannelNo=e,window.currRowChannelName=a};var et={name:"ModuleChConfig",components:{ApiDataTable:w,ChannelEditDlg:V,ChannelDeleteDlg:W,ChannelAlgConfigDlg:tt},data:function(){return{channelListTableId:C["a"].randomId("tableId"),channelEditDlgId:C["a"].randomId("modalId"),channelDeleteDlgId:C["a"].randomId("modalId"),channelAlgConfigDlgId:C["a"].randomId("modalId"),tableComp:null,currRowChannelId:0,currRowChannelNo:0,currRowChannelName:"",freeNos:[1,2,3,4,5,6,7,8],usedNos:[]}},computed:{tableHandlers:function(){return{setComponent:this.tableSetComponent,getEndpoint:this.tableGetEndPoint,getParams:this.tableGetParams,tableRowFormatter:this.tableRowFormatter,getColSpecs:this.tableGetColSpecs,rowStyle:this.rowStyle,getDataList:this.getDataList,onPageLoaded:this.onPageLoaded}},availNos:function(){var t=[].concat(Object(l["a"])(this.freeNos),Object(l["a"])(this.usedNos));return t.sort()}},methods:{onChannelSaved:function(){this.reloadTable(),this.getUsedFreeChannels()},onChannelDeleted:function(){this.reloadTable(),this.getUsedFreeChannels()},onChannelAlgSaved:function(){},tableSetComponent:function(t){this.tableComp=t},tableRowFormatter:function(t){return{id:t.id,cno:t.cno,cid:t.cid,name:t.name,site:t.site,url:t.url,status:"...",operation:'\n          <a href="javascript:channelRowSelected('.concat(t.id,", ").concat(t.cno,", '").concat(t.name,"');$('#").concat(this.channelEditDlgId,"').modal('show')\">编辑</a>\n          <a href=\"javascript:channelRowSelected(").concat(t.id,", ").concat(t.cno,", '").concat(t.name,"');$('#").concat(this.channelDeleteDlgId,"').modal('show')\">删除</a>\n          <a href=\"javascript:channelRowSelected(").concat(t.id,", ").concat(t.cno,", '").concat(t.name,"');$('#").concat(this.channelAlgConfigDlgId,"').modal('show')\">算法配置</a>\n        ")}},tableGetParams:function(){return{ordering:"cno"}},tableGetEndPoint:function(){return"channel/channels/"},tableGetColSpecs:function(){var t=[{field:"id",title:"ID",visible:!1},{field:"cno",title:"通道编号"},{field:"cid",title:"通道ID"},{field:"name",title:"通道名称"},{field:"site",title:"通道位置"},{field:"url",title:"URL"},{field:"status",title:"状态"},{field:"operation",title:"操作"}];return t},onTableSelectionChanged:function(){},reloadTable:function(){this.tableComp&&this.tableComp.getOnePage(),this.onTableSelectionChanged()},onPageLoaded:function(t,e){var a=this,n="channel/channels/get_real_time_status/?channel_ids=".concat(e.map((function(t){return t.id})).join(","));console.log("onPageLoaded",e,n),h["a"].apiAjaxGet(n,{},(function(t){0===t.code&&e.forEach((function(e,n){e.id in t.data&&a.tableComp.table.bootstrapTable("updateCell",{index:n,field:"status",value:'\n                  <span class="icon iconfont icon-dot" style="color: '.concat(t.data[e.id]?"green":"gray",';"></span>\n                  ').concat(t.data[e.id]?"在线":"离线","\n                ")})}))}),C["a"].defaultApiErrorHandler(n,""))},rowStyle:function(){var t={};return t},getDataList:function(t){return t.data.results},getUsedFreeChannels:function(){var t=this,e="channel/channels/get_used_free_channel_nos/";h["a"].apiAjaxGet(e,{},(function(e){0===e.code&&(t.freeNos=e.data.free_nos,t.usedNos=e.data.used_nos)}),C["a"].defaultApiErrorHandler(e,""))},beforeModalShow:function(){this.currRowChannelId=window.currRowChannelId,this.currRowChannelNo=window.currRowChannelNo,this.currRowChannelName=window.currRowChannelName,console.log("beforeModalShow",this.currRowChannelId,this.currRowChannelNo,this.currRowChannelName)}},mounted:function(){var t=this;u()("#".concat(this.channelEditDlgId)).on("show.bs.modal",(function(e){"relatedTarget"in e?t.currRowChannelId=0:t.beforeModalShow()})),u()("#".concat(this.channelDeleteDlgId)).on("show.bs.modal",(function(){t.beforeModalShow()})),u()("#".concat(this.channelAlgConfigDlgId)).on("show.bs.modal",(function(){t.beforeModalShow()})),this.getUsedFreeChannels()}},at=et,nt=Object(p["a"])(at,n,o,!1,null,null,null);e["default"]=nt.exports},9761:function(t,e,a){"use strict";a("afa5")},afa5:function(t,e,a){}}]);